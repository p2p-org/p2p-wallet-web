{"version":3,"sources":["components/ui/Modal/Modal.tsx","components/common/ButtonCancel/ButtonCancel.tsx","components/modals/ReceiveBitcoinModal/common/styled.ts","components/modals/ReceiveBitcoinModal/Create/Create.tsx","components/modals/ReceiveBitcoinModal/TopUp/TopUp.tsx","components/modals/ReceiveBitcoinModal/ReceiveBitcoinModal.tsx"],"names":["easing","BezierEasing","AnimatedDialogContent","animated","StyledDialogContent","props","mobile","Handle","Header","Delimiter","IconWrapper","IconStyled","Title","Description","CloseIcon","Content","Footer","Modal","children","useState","isMobile","useIsMobile","location","useLocation","currentPath","useRef","useEffect","close","doNotCloseOnPathChangeMobile","setIsOpen","config","useMemo","duration","t","from","transform","enter","leave","fadeTransition","useTransition","isOpen","useSpring","y","mass","tension","friction","bind","useDrag","state","set","item","style","n","className","title","description","name","onClick","noDelimiter","classNames","hasIcon","Boolean","iconName","footer","CancelIcon","ButtonCancel","hollow","error","WrapperModal","Section","List","Row","Create","solanaProvider","useSolana","network","useRenNetwork","tokenAccounts","useUserTokenAccounts","expiryTime","useLockAndMintProvider","handleCreateAccountClick","a","setCreating","Bitcoin","ToastManager","console","iconBgClassName","primary","onTokenAccountChange","nextTokenAccount","isShortList","milliseconds","getRemainingGatewayTime","TopUp","history","useHistory","trackEvent","ReceiveBitcoinModal","nativeBalance","toU64","toNumber","accountRentExemption"],"mappings":"gUAgBMA,EAASC,IAAa,IAAD,MAA3B,KAEMC,EAAwBC,YAA9B,KAKMC,EAAmB,aAAU,gBAAMC,EAAN,2BAAkB,+BAA5B,sEAGT,qBAAGC,OAAuB,SAHjB,cA0CnBC,EAAM,qDAoBNC,EAAM,oDAWNC,EAAS,uDA2BTC,EAAW,yDAsBXC,EAAU,sDAYVC,EAAK,mDAQLC,EAAW,0DAQXC,EAAS,qDAaFC,EAAO,qDAQdC,EAAM,qDA0BCC,EAAuC,SAAC,GAa/C,IAb+C,EAa/C,EAb+C,QAa/C,EAb+C,cAa/C,EAb+C,SAa/C,EAb+C,WAa/C,EAb+C,kBAa/C,EAb+C,cAa/C,EAb+C,QAa/C,EAb+C,+BAa/C,EAb+C,UAYnDC,EACI,EADJA,SAEA,EAA4BC,oBAA5B,sBAAM,EAAN,KAAM,EAAN,KACMC,EAAWC,cACXC,EAAWC,cACXC,EAAcC,iBAAOH,EAA3B,UAEAI,qBAAU,WACJN,OAA6CI,YAAwBF,EAAzE,UACEK,MAED,CAACP,EAAUQ,EAA8BN,EAJ5CI,WAMAA,qBAAU,WAGR,OAFAG,MAEO,WACLA,SAJJH,IAQA,IAAMI,EAASC,mBAAQ,WACrB,SACS,CACLD,OAAQ,CAAEE,SAAF,IAAiBhC,OAAQ,mBAAeA,EAAOiC,KACvDC,KAAM,CAAEC,UAAW,qBACnBC,MAAO,CAAED,UAAW,iBACpBE,MAAO,CAAEF,UAAW,sBAIjB,KAMN,CAhBH,IAkBMG,EAAiBC,YAAcC,EAAQ,KAA7C,GAEA,EAAqBC,aAAU,iBAAO,CAAEC,EAAF,EAAQZ,OAAQ,CAAEa,KAAF,EAAWC,QAAX,IAAyBC,SAAU,QAAzF,mBAASH,EAAT,KAASA,EAAH,EAAN,KACMI,EAAOC,mBAASC,YACpBC,EAAI,CACFP,EAAGM,OAAaA,WAAbA,GAAiC,KAGpCA,cAnQN,KAoQOA,cAnQP,GAmQsDA,eAFlD,IAIErB,OAIJ,OACE,mCACGW,OACC,gBAAC,EAAD,EAAC,OAAD,EAAC,IAAajC,EAAd,EAAcA,MAAd,OACE6C,GACE,4CAEO9B,EAAQ,2BAEJ0B,KAFI,IAGPK,MAAO,8BAAF,IAEHhB,UAAWO,eAAeU,YAAD,2BAAqB,MAAnCV,EAAc,cAG7B,CACES,MAAO9C,IAXf,IAaE,aAbF,SAcEgD,UAdF,YAgBGjC,EAAW,cAAH,EAAG,SAAZ,EACCkC,KACC,4BACGA,EAAQ,0BAAH,SAAN,EACCC,EAAc,0BAAH,SAAZ,EACEnC,OAAF,EAAa,iBAAWoC,KAAX,QAAwBC,QAApC,YAJL,EAOEC,OAAF,EACE,iBAAWL,UAAWM,IAAW,CAAEC,QAASC,QAAQC,KAApD,SACGA,EACC,iBAAaT,UAAb,WACE,iBAAYG,KAAZ,WAFJ,IAOHtC,EAAW,0BAAH,SAAT,EACC6C,EAAS,0BAAH,SAAP,KAlCF,S,wHC5RNC,EAAU,uDAQHC,EAA2B5D,YACtC,OACE,qDAAmB6D,QAAnB,EAA0BC,OAA1B,YACE,iBAAYX,KAAZ,UADF,c,uTCbSY,EAAY,wDAIZC,EAAO,sDAMPC,EAAI,iDAOJC,EAAG,gD,mBCIHC,EAAoB,SAAC,GAAc,IAAZ7C,EAAY,EAAZA,MAC5B8C,EAAiBC,cACjBC,EAAUC,cACVC,EAAgBC,cACdC,EAAeC,cAAfD,WAGR,EAAgC5D,oBAAhC,sBAAM,GAAN,WAWM8D,EAAwB,uCAAG,sBAAAC,EAAA,sEAE7BC,MAF6B,SAGvB,IAAI,EAAJ,oCAAiEC,IAAvE,OAH6B,OAI7BzD,MAJ6B,gDAM7B0D,UAAmB,KAAnBA,SACAC,oBAP6B,yBAS7BH,MAT6B,4EAAH,qDAa9B,OACE,iBACE7B,MADF,gCAEEC,YAFF,yCAGEO,SAHF,QAIEyB,gBAJF,UAKE5D,MAAO,kBAAMA,GALf,IAMEoC,OACE,qCACE,mBAAQyB,SAAR,EAAgB/B,QAAhB,2CAGA,mBAAcA,QAAS,kBAAM9B,GAA7B,SAXN,SAeE,4BACE,0BACE,oGACuE,IACrE,oEAFF,wDAOF,mBAAS6B,KAAT,aACE,mBACEqB,cADF,EAEEY,qBAlD0B,SAAC,EAAD,GAI9B,OAACC,QAAD,IAACA,KAAL,KA+CQC,aAHF,MAOF,4BACE,oDACuB,kDADvB,oDAIA,6DACgC,kDADhC,OAGA,4BACE,iCACE,mBAAcC,aAAcC,YAA5B,OAFJ,mE,gBCrFGC,EAAmB,SAAC,GAAc,IAAZnE,EAAY,EAAZA,MAC3BoE,EAAUC,cAShB,OACE,iBACE1C,MADF,gCAEEC,YAFF,yCAGEO,SAHF,QAIEyB,gBAJF,UAKE5D,MAAO,kBAAMA,GALf,IAMEoC,OACE,qCACE,mBAAQyB,SAAR,EAAgB/B,QAhBC,WACvBwC,kCAEAtE,MACAoE,gBAYM,iCAGA,mBAActC,QAAS,kBAAM9B,GAA7B,SAXN,SAeE,0BACE,4BACE,iCACI,gEADJ,oDAIA,oGACuE,IACrE,oEAFF,OAIA,mCACM,sDADN,oHCjCGuE,EAA0D,SAAC7F,GAAU,QAKhF,OAJoB,oBAAGA,EAAM8F,qBAAT,aAAG,EAAqBC,QAAQC,kBAAhC,QAA8C,GACnChG,EAAMiG,qBAAqBD,WAIjD,cAAC,EAAD,CAAQ1E,MAAOtB,EAAMsB,QAGvB,cAAC,EAAD,CAAOA,MAAOtB,EAAMsB","file":"static/js/6.dcf3644e.chunk.js","sourcesContent":["import type { FunctionComponent } from 'react';\nimport * as React from 'react';\nimport { useEffect, useMemo, useRef, useState } from 'react';\nimport { useLocation } from 'react-router';\nimport { animated, useSpring, useTransition } from 'react-spring';\n\nimport { styled } from '@linaria/react';\nimport { theme, up, useIsMobile } from '@p2p-wallet-web/ui';\nimport { DialogContent } from '@reach/dialog';\nimport { useDrag } from '@use-gesture/react';\nimport BezierEasing from 'bezier-easing';\nimport classNames from 'classnames';\n\nimport { Icon } from 'components/ui';\n\n// eslint-disable-next-line @typescript-eslint/no-magic-numbers\nconst easing = BezierEasing(0.7, -0.4, 0.4, 1.4);\n\nconst AnimatedDialogContent = animated(DialogContent);\n\nconst DRAG_MOVEMENT_THRESHOLD = 300;\nconst DRAG_VELOCITY_THRESHOLD = 3;\n\nconst StyledDialogContent = styled(({ ...props }) => <AnimatedDialogContent {...props} />)`\n  max-height: calc(100vh - 80px);\n\n  overflow-y: ${({ mobile }) => (mobile ? 'scroll' : 'hidden')};\n\n  &[data-reach-dialog-content] {\n    position: fixed;\n    right: 0;\n\n    display: flex;\n    flex-direction: column;\n    align-self: flex-end;\n    width: 100%;\n    margin: 0;\n    padding: 0;\n    overflow-x: hidden;\n    overflow-y: scroll;\n\n    background: ${theme.colors.bg.primary};\n    border-radius: 18px 18px 0 0;\n\n    touch-action: none;\n\n    ${up.tablet} {\n      position: relative;\n      right: unset;\n      bottom: unset;\n\n      align-self: center;\n      width: unset;\n      height: unset;\n      margin: 0;\n\n      border-radius: 12px;\n    }\n  }\n\n  &:focus-visible {\n    outline: none;\n  }\n`;\n\nconst Handle = styled.div`\n  position: relative;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 16px;\n\n  &::before {\n    position: absolute;\n\n    width: 31px;\n    height: 4px;\n\n    background: ${theme.colors.textIcon.buttonDisabled};\n\n    content: '';\n  }\n`;\n\nconst Header = styled.div`\n  position: relative;\n\n  display: inline-flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n\n  min-height: 74px;\n`;\n\nconst Delimiter = styled.div`\n  position: relative;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  &.hasIcon {\n    height: 44px;\n\n    ${up.tablet} {\n      height: 56px;\n    }\n  }\n\n  &::before {\n    position: absolute;\n\n    width: 100%;\n    height: 1px;\n\n    background: ${theme.colors.stroke.secondary};\n\n    content: '';\n  }\n`;\n\nconst IconWrapper = styled.div`\n  z-index: 1;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  width: 44px;\n  height: 44px;\n\n  border-radius: 12px;\n\n  ${up.tablet} {\n    width: 56px;\n    height: 56px;\n  }\n\n  &.warning {\n    background: ${theme.colors.system.warningMain};\n  }\n`;\n\nconst IconStyled = styled(Icon)`\n  width: 24px;\n  height: 24px;\n\n  color: ${theme.colors.textIcon.buttonPrimary};\n\n  ${up.tablet} {\n    width: 32px;\n    height: 32px;\n  }\n`;\n\nconst Title = styled.div`\n  color: ${theme.colors.textIcon.primary};\n  font-weight: 500;\n  font-size: 20px;\n  line-height: 140%;\n  letter-spacing: 0.01em;\n`;\n\nconst Description = styled.div`\n  color: ${theme.colors.textIcon.secondary};\n  font-weight: 500;\n  font-size: 14px;\n  line-height: 120%;\n  letter-spacing: 0.01em;\n`;\n\nconst CloseIcon = styled(Icon)`\n  position: absolute;\n  top: 25px;\n  right: 20px;\n\n  width: 24px;\n  height: 24px;\n\n  color: ${theme.colors.textIcon.active};\n\n  cursor: pointer;\n`;\n\nexport const Content = styled.div`\n  padding: 0 16px;\n\n  ${up.tablet} {\n    padding: 0 20px;\n  }\n`;\n\nconst Footer = styled.div`\n  display: grid;\n  grid-auto-flow: row;\n  grid-gap: 16px;\n  margin-bottom: 16px;\n  padding: 0 16px;\n\n  ${up.tablet} {\n    grid-auto-flow: column;\n    padding: 20px;\n  }\n`;\n\nexport type ModalProps = {\n  title?: React.ReactNode;\n  description?: React.ReactNode;\n  footer?: React.ReactNode;\n  iconName?: string;\n  iconBgClassName?: string;\n\n  noDelimiter?: boolean;\n  close: () => void;\n  doNotCloseOnPathChangeMobile?: boolean;\n  className?: string;\n};\n\nexport const Modal: FunctionComponent<ModalProps> = ({\n  title,\n  description,\n  footer,\n  iconName,\n  iconBgClassName,\n\n  noDelimiter,\n  close,\n  doNotCloseOnPathChangeMobile,\n  className,\n\n  children,\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const isMobile = useIsMobile();\n  const location = useLocation();\n  const currentPath = useRef(location.pathname);\n\n  useEffect(() => {\n    if (isMobile && !doNotCloseOnPathChangeMobile && currentPath.current !== location.pathname) {\n      close();\n    }\n  }, [isMobile, doNotCloseOnPathChangeMobile, location.pathname]);\n\n  useEffect(() => {\n    setIsOpen(true);\n\n    return () => {\n      setIsOpen(false);\n    };\n  }, []);\n\n  const config = useMemo(() => {\n    if (isMobile) {\n      return {\n        config: { duration: 600, easing: (t: number) => easing(t) },\n        from: { transform: 'translateY(100px)' },\n        enter: { transform: 'translateX(0)' },\n        leave: { transform: 'translateY(100px)' },\n      };\n    }\n\n    return {\n      // config: { duration: 600, easing: (t: number) => easing(t) },\n      // from: { transform: 'translateX(422px)' },\n      // enter: { transform: 'translateX(0)' },\n      // leave: { transform: 'translateX(422px)' },\n    };\n  }, [isMobile]);\n\n  const fadeTransition = useTransition(isOpen, null, config);\n\n  const [{ y }, set] = useSpring(() => ({ y: 0, config: { mass: 1, tension: 210, friction: 20 } }));\n  const bind = useDrag((state) => {\n    set({\n      y: state.down ? state.movement[1] : 0,\n    });\n    if (\n      state.movement[1] > DRAG_MOVEMENT_THRESHOLD ||\n      (state.velocity[1] > DRAG_VELOCITY_THRESHOLD && state.direction[1] > 0)\n    ) {\n      close();\n    }\n  });\n\n  return (\n    <>\n      {fadeTransition.map(\n        ({ item, key, props }) =>\n          item && (\n            <StyledDialogContent\n              key={key}\n              {...(isMobile\n                ? {\n                    ...bind(),\n                    style: {\n                      ...props,\n                      transform: y.interpolate((n) => `translateY(${(n as number) > 0 ? n : 0}px)`),\n                    },\n                  }\n                : {\n                    style: props,\n                  })}\n              aria-label=\"dialog\"\n              className={className}\n            >\n              {isMobile ? <Handle /> : undefined}\n              {title || description ? (\n                <Header>\n                  {title ? <Title>{title}</Title> : undefined}\n                  {description ? <Description>{description}</Description> : undefined}\n                  {!isMobile ? <CloseIcon name=\"cross\" onClick={close} /> : undefined}\n                </Header>\n              ) : undefined}\n              {!noDelimiter ? (\n                <Delimiter className={classNames({ hasIcon: Boolean(iconName) })}>\n                  {iconName ? (\n                    <IconWrapper className={iconBgClassName}>\n                      <IconStyled name={iconName} />\n                    </IconWrapper>\n                  ) : undefined}\n                </Delimiter>\n              ) : undefined}\n              {children ? <Content>{children}</Content> : undefined}\n              {footer ? <Footer>{footer}</Footer> : undefined}\n            </StyledDialogContent>\n          ),\n      )}\n    </>\n  );\n};\n","import type { FC } from 'react';\nimport * as React from 'react';\n\nimport { styled } from '@linaria/react';\n\nimport { Button, Icon } from 'components/ui';\n\nconst CancelIcon = styled(Icon)`\n  width: 24px;\n  height: 24px;\n  margin-right: 8px;\n`;\n\ntype Props = React.ButtonHTMLAttributes<HTMLButtonElement>;\n\nexport const ButtonCancel: FC<Props> = (props) => {\n  return (\n    <Button {...props} hollow error>\n      <CancelIcon name=\"cross\" />\n      Cancel\n    </Button>\n  );\n};\n","import { styled } from '@linaria/react';\n\nimport { Modal } from 'components/ui/Modal';\n\nexport const WrapperModal = styled(Modal)`\n  flex-basis: 524px;\n`;\n\nexport const Section = styled.div`\n  display: grid;\n  grid-gap: 24px;\n  padding: 16px 0 24px;\n`;\n\nexport const List = styled.ul`\n  display: grid;\n  grid-gap: 16px;\n  margin: 0;\n  padding-left: 32px;\n`;\n\nexport const Row = styled.li``;\n","import type { FC } from 'react';\nimport { useState } from 'react';\n\nimport type { TokenAccount } from '@p2p-wallet-web/core';\nimport { useSolana, useUserTokenAccounts } from '@p2p-wallet-web/core';\nimport { Bitcoin } from '@renproject/chains-bitcoin';\nimport { Solana } from '@renproject/chains-solana';\nimport type { Token } from '@saberhq/token-utils';\nimport { Feature } from 'flagged';\n\nimport type { ModalPropsType } from 'app/contexts';\nimport { ButtonCancel } from 'components/common/ButtonCancel';\nimport { FeePaySelector } from 'components/common/FeePaySelector';\nimport { HMSCountdown } from 'components/common/HMSCountdown';\nimport { ToastManager } from 'components/common/ToastManager';\nimport { Button } from 'components/ui';\nimport { FEATURE_PAY_BY } from 'config/featureFlags';\nimport { getRemainingGatewayTime } from 'utils/hooks/renBridge/useLockAndMint';\nimport { useRenNetwork } from 'utils/hooks/renBridge/useNetwork';\nimport { useLockAndMintProvider } from 'utils/providers/LockAndMintProvider';\n\nimport { List, Row, Section, WrapperModal } from '../common/styled';\n\ntype Props = ModalPropsType;\n\nexport const Create: FC<Props> = ({ close }) => {\n  const solanaProvider = useSolana();\n  const network = useRenNetwork();\n  const tokenAccounts = useUserTokenAccounts();\n  const { expiryTime } = useLockAndMintProvider();\n\n  // TODO: use for progress bar in Modal. Add this feature to modal\n  const [creating, setCreating] = useState(false);\n\n  const handleFeeTokenAccountChange = (\n    _nextToken: Token,\n    nextTokenAccount: TokenAccount | null,\n  ) => {\n    if (!nextTokenAccount?.key) {\n      return;\n    }\n  };\n\n  const handleCreateAccountClick = async () => {\n    try {\n      setCreating(true);\n      await new Solana(solanaProvider, network).createAssociatedTokenAccount(Bitcoin.asset);\n      close(true);\n    } catch (error) {\n      ToastManager.error((error as Error).message);\n      console.error(error);\n    } finally {\n      setCreating(false);\n    }\n  };\n\n  return (\n    <WrapperModal\n      title=\"Receiving via Bitcoin network\"\n      description=\"Make sure you understand these aspects\"\n      iconName=\"clock\"\n      iconBgClassName=\"warning\"\n      close={() => close(false)}\n      footer={\n        <>\n          <Button primary onClick={handleCreateAccountClick}>\n            Pay 0.002928 SOL & Continue\n          </Button>\n          <ButtonCancel onClick={() => close(false)} />\n        </>\n      }\n    >\n      <Section>\n        <List>\n          <Row>\n            Your wallet list does not contain a renBTC account, and to create one{' '}\n            <strong>you need to make a transaction</strong>. You can choose which currency to pay in\n            below.\n          </Row>\n        </List>\n\n        <Feature name={FEATURE_PAY_BY}>\n          <FeePaySelector\n            tokenAccounts={tokenAccounts}\n            onTokenAccountChange={handleFeeTokenAccountChange}\n            isShortList\n          />\n        </Feature>\n\n        <List>\n          <Row>\n            This address accepts <strong>only Bitcoin</strong>. You may lose assets by sending\n            another coin.\n          </Row>\n          <Row>\n            Minimum transaction amount of <strong>0.000112 BTC</strong>.\n          </Row>\n          <Row>\n            <strong>\n              <HMSCountdown milliseconds={getRemainingGatewayTime(expiryTime)} />\n            </strong>\n            &nbsp; is the remaining time to safely send the assets\n          </Row>\n        </List>\n      </Section>\n    </WrapperModal>\n  );\n};\n","import type { FC } from 'react';\nimport { useHistory } from 'react-router';\n\nimport type { ModalPropsType } from 'app/contexts';\nimport { ButtonCancel } from 'components/common/ButtonCancel';\nimport { Button } from 'components/ui';\nimport { trackEvent } from 'utils/analytics';\n\nimport { List, Row, Section, WrapperModal } from '../common/styled';\n\ntype Props = ModalPropsType;\n\nexport const TopUp: FC<Props> = ({ close }) => {\n  const history = useHistory();\n\n  const handleTopUpClick = () => {\n    trackEvent('Receive_Topping_Up');\n\n    close(false);\n    history.push('/buy');\n  };\n\n  return (\n    <WrapperModal\n      title=\"Receiving via Bitcoin network\"\n      description=\"Make sure you understand these aspects\"\n      iconName=\"clock\"\n      iconBgClassName=\"warning\"\n      close={() => close(false)}\n      footer={\n        <>\n          <Button primary onClick={handleTopUpClick}>\n            Top up your account\n          </Button>\n          <ButtonCancel onClick={() => close(false)} />\n        </>\n      }\n    >\n      <Section>\n        <List>\n          <Row>\n            A <strong>renBTC account is required</strong> to receive bitcoins over the Bitcoin\n            network.\n          </Row>\n          <Row>\n            Your wallet list does not contain a renBTC account, and to create one{' '}\n            <strong>you need to make a transaction</strong>.\n          </Row>\n          <Row>\n            You <strong>don't have funds</strong> to pay for account creation, but if someone sends\n            renBTC to your address, it will be created for you.\n          </Row>\n        </List>\n      </Section>\n    </WrapperModal>\n  );\n};\n","import type { FC } from 'react';\n\nimport type { TokenAmount } from '@p2p-wallet-web/token-utils';\nimport type { u64 } from '@solana/spl-token';\n\nimport type { ModalPropsType } from 'app/contexts';\n\nimport { Create } from './Create';\nimport { TopUp } from './TopUp';\n\ninterface Props {\n  accountRentExemption: u64;\n  nativeBalance: TokenAmount;\n}\n\nexport const ReceiveBitcoinModal: FC<ModalPropsType<boolean, Props>> = (props) => {\n  const nativeLamports = props.nativeBalance?.toU64().toNumber() ?? 0;\n  const lamportsRentExcemption = props.accountRentExemption.toNumber();\n  const isEnoughSol = nativeLamports > lamportsRentExcemption;\n\n  if (isEnoughSol) {\n    return <Create close={props.close} />;\n  }\n\n  return <TopUp close={props.close} />;\n};\n"],"sourceRoot":""}